import { StatusCodes } from 'http-status-codes'
const request = require('supertest')
const app = require('../app')
import setup from './database/setup'
import jwt from 'jsonwebtoken'


jest.setTimeout(30000)
beforeAll(async () => await setup())

const genToken = (email, _id, ruolo) => {
  var payload = { email: email, _id:_id, ruolo:ruolo}
  var options = { expiresIn: 86400} // expires in 24 hours
  var token = jwt.sign(payload, process.env.SUPER_SECRET, options)
  return token
}

describe('POST /register', () => {
  test('POST /register OK', () => {
    return request(app).post('/register')
    .send({
      email:'giovanni1.rossi@gmail.com',
      password:'password',
      indirizzo: 'Via dei Valoni 31',
      nome: 'Giovanni',
      cognome: 'Rossi',
      telefono: 31
    })
    .expect(StatusCodes.CREATED)
    .expect((res) =>{
      expect(res.body?.message).toBe('New Cliente created')
      expect(res.body).toHaveProperty('_id')
    })
  })
  test('POST /register Email already used', () => {
    return request(app).post('/register')
    .send({
      email:'mario.rossi@gmail.com',
      password:'password',
      indirizzo: 'Via dei Valoni 32',
      nome: 'Giovanni2',
      cognome: 'Rossi',
      telefono: 32
    })
    .expect(StatusCodes.CONFLICT)
    .expect((res) =>{
      expect(res.body).not.toHaveProperty('_id')
      expect(res.body?.code).toBe(0)
      expect(res.body?.message).toBe('Error registering Cliente - email already used');
    })
  })
  test('POST /register Telefono already used', () => {
    return request(app).post('/register')
    .send({
      email:'giovanni3.rossi@gmail.com',
      password:'password',
      indirizzo: 'Via dei Valoni 33',
      nome: 'Giovanni3',
      cognome: 'Rossi',
      telefono: 1
    })
    .expect(StatusCodes.CONFLICT)
    .expect((res) =>{
      expect(res.body).not.toHaveProperty('_id')
      expect(res.body?.code).toBe(1)
      expect(res.body?.message).toBe('Error registering Cliente - telefono already used')
    })
  })
})

describe('GET /myAcc', () => {
  test('GET /myAcc OK', () => {
    return request(app).get('/myAcc')
    .set('x-access-token',genToken(
      'mario.rossi@gmail.com',
      '639f1c3274aef65fb510cb79',
      'cliente'
      ))
    .send()
    .expect(StatusCodes.OK)
    .expect('x-token-status', 'valid')
    .expect({
      email: 'mario.rossi@gmail.com',
      password: '$2b$10$bB6fwaC7DCR2NAjB7n7dM.qpmB9iLd5PhKIRPPGC.TPyAS09Tu9o2',
      indirizzo: 'Via dei Valoni 1',
      nome: 'Mario',
      cognome: 'Rossi',
      telefono: '1'
    })
  })
})

describe('GET /myAcc/impianti', () => {
  test('GET /myAcc/impianti OK', () => {
    return request(app).get('/myAcc/impianti')
    .set('x-access-token',genToken(
      'mario.rossi@gmail.com',
      '639f1c3274aef65fb510cb79',
      'cliente'
      ))
    .send()
    .expect(StatusCodes.OK)
    .expect('x-token-status', 'valid')
    .expect([
      {
        _id: '639f2df174aef65fb510cb8f',
        modello: 'FP200A',
        indirizzo: 'Panarotta SP11, 38056 Levico Terme TN',
        fattura: '697999697895',
        superficie: 26.35,
        dataAcquisto: '2022-12-12T00:00:00.000Z',
        isDismesso: false,
        lat: 46.03445003002628,
        long: 11.313431342955184
      }
    ])
  })  
})

describe('GET /myAcc/impianti/:selImpId/heatmap', () => {
  test('GET /myAcc/impianti/:selImpId/heatmap OK', () => {
    return request(app).get('/myAcc/impianti/639f2df174aef65fb510cb8f/heatmap')
    .set('x-access-token', genToken(
      'mario.rossi@gmail.com',
      '639f1c3274aef65fb510cb79',
      'cliente'
      ))
    .send()
    .expect(StatusCodes.OK)
    .expect('x-token-status', 'valid')
    .expect({"lat":46.03445003002628,"long":11.313431342955184,"parametri":[{"name":"tvoc","uom":"ppb"},{"name":"temp","uom":"Â°C"},{"name":"CO2","uom":"ppm"},{"name":"hum_rel","uom":"%"},{"name":"O2","uom":"ppm"}],"sensori":[{"_id":"63a06ea2daceb65b1eebfb55","lat":46.05179413900221,"long":11.401882739098822,"isDismesso":false},{"_id":"63a06ea2daceb65b1eebfb57","lat":46.04505165196745,"long":11.307823447672135,"isDismesso":false},{"_id":"63a06ea2daceb65b1eebfb59","lat":46.04938218813776,"long":11.358793769787042,"isDismesso":false},{"_id":"63a06ea2daceb65b1eebfb5b","lat":46.03073878900449,"long":11.279092210421176,"isDismesso":false},{"_id":"63a06ea2daceb65b1eebfb5d","lat":46.03857548603199,"long":11.270872812514872,"isDismesso":false},{"_id":"63a06ea2daceb65b1eebfb5f","lat":46.0316902016604,"long":11.330453228554633,"isDismesso":false},{"_id":"63a06ea3daceb65b1eebfb61","lat":46.031987120624066,"long":11.274998897489224,"isDismesso":false},{"_id":"63a06ea3daceb65b1eebfb63","lat":46.03271093771528,"long":11.292981881231826,"isDismesso":false},{"_id":"63a06ea3daceb65b1eebfb65","lat":46.05845899024547,"long":11.389718474870458,"isDismesso":false},{"_id":"63a06ea3daceb65b1eebfb67","lat":46.042200256956555,"long":11.304776494967939,"isDismesso":false},{"_id":"63a06ea3daceb65b1eebfb69","lat":46.04920714616241,"long":11.340822792255766,"isDismesso":false},{"_id":"63a06ea3daceb65b1eebfb6b","lat":46.04828384190932,"long":11.348255802201114,"isDismesso":false},{"_id":"63a06ea3daceb65b1eebfb6d","lat":46.043654398440395,"long":11.376222803504819,"isDismesso":false},{"_id":"63a06ea3daceb65b1eebfb6f","lat":46.05142721419871,"long":11.382143362731702,"isDismesso":false},{"_id":"63a06ea3daceb65b1eebfb71","lat":46.032728064582564,"long":11.278754264148835,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb73","lat":46.03449388784218,"long":11.359015063868576,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb75","lat":46.033251327633444,"long":11.362688088087005,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb77","lat":46.05627391185387,"long":11.382859961038955,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb79","lat":46.025081141777505,"long":11.296564072974585,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb7b","lat":46.03316843596937,"long":11.353767445237777,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb7d","lat":46.05734455546021,"long":11.394435808253919,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb7f","lat":46.04589632109839,"long":11.38080079236096,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb81","lat":46.02954743893706,"long":11.348301146085673,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb83","lat":46.04521707617695,"long":11.32059272489313,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb85","lat":46.04572351022925,"long":11.368186479807914,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb87","lat":46.055446203910975,"long":11.3806946689629,"isDismesso":false},{"_id":"63a06ea4daceb65b1eebfb89","lat":46.04619334203617,"long":11.371490790045423,"isDismesso":false},{"_id":"63a06ea5daceb65b1eebfb8b","lat":46.027357443729315,"long":11.28378819887341,"isDismesso":false},{"_id":"63a06ea5daceb65b1eebfb8d","lat":46.04491087998939,"long":11.377570892326654,"isDismesso":false},{"_id":"63a06ea5daceb65b1eebfb8f","lat":46.05050868823169,"long":11.290234777310268,"isDismesso":false},{"_id":"63a06ea5daceb65b1eebfb91","lat":46.04891349743256,"long":11.381625346075701,"isDismesso":false},{"_id":"63a06ea5daceb65b1eebfb93","lat":46.04419217892893,"long":11.370122020038679,"isDismesso":false},{"_id":"63a06ea6daceb65b1eebfb95","lat":46.02652123180739,"long":11.297356226664604,"isDismesso":false},{"_id":"63a06ea6daceb65b1eebfb97","lat":46.034510470721585,"long":11.31164634518258,"isDismesso":false},{"_id":"63a06ea6daceb65b1eebfb99","lat":46.05549257120881,"long":11.391003103943412,"isDismesso":false},{"_id":"63a06ea6daceb65b1eebfb9b","lat":46.032485006749894,"long":11.31745016891234,"isDismesso":false},{"_id":"63a06ea6daceb65b1eebfb9d","lat":46.03077239563108,"long":11.34423144038576,"isDismesso":false},{"_id":"63a06ea6daceb65b1eebfb9f","lat":46.03044903026864,"long":11.289889899726045,"isDismesso":false},{"_id":"63a06ea6daceb65b1eebfba1","lat":46.047607966037404,"long":11.389203730373472,"isDismesso":false},{"_id":"63a06ea6daceb65b1eebfba3","lat":46.028086119264856,"long":11.343379100019025,"isDismesso":false},{"_id":"63a06ea6daceb65b1eebfba5","lat":46.033855327225126,"long":11.363529515232418,"isDismesso":false},{"_id":"63a06ea6daceb65b1eebfba7","lat":46.036025408169614,"long":11.341246932679907,"isDismesso":false},{"_id":"63a06ea7daceb65b1eebfba9","lat":46.028883766776936,"long":11.279043106798184,"isDismesso":false},{"_id":"63a06ea7daceb65b1eebfbab","lat":46.04551314260851,"long":11.317783152469877,"isDismesso":false},{"_id":"63a06ea7daceb65b1eebfbad","lat":46.029840402244766,"long":11.290340929225799,"isDismesso":false},{"_id":"63a06ea7daceb65b1eebfbaf","lat":46.03017549780059,"long":11.305950311212312,"isDismesso":false},{"_id":"63a06ea7daceb65b1eebfbb1","lat":46.05122719916646,"long":11.402952308731113,"isDismesso":false},{"_id":"63a06ea7daceb65b1eebfbb3","lat":46.028199294493525,"long":11.337961891143621,"isDismesso":false},{"_id":"63a06ea8daceb65b1eebfbb5","lat":46.03000851662546,"long":11.357230141894854,"isDismesso":false},{"_id":"63a06ea8daceb65b1eebfbb7","lat":46.04932115048693,"long":11.394347762135729,"isDismesso":false},{"_id":"63a06ea8daceb65b1eebfbb9","lat":46.039093405272375,"long":11.370835183055556,"isDismesso":false},{"_id":"63a06ea8daceb65b1eebfbbb","lat":46.03032470088396,"long":11.297501347837315,"isDismesso":false},{"_id":"63a06ea8daceb65b1eebfbbd","lat":46.039690913054464,"long":11.309042385758964,"isDismesso":false},{"_id":"63a06ea8daceb65b1eebfbbf","lat":46.038912008334684,"long":11.319578711207404,"isDismesso":false},{"_id":"63a06ea9daceb65b1eebfbc1","lat":46.035571217796836,"long":11.306875820127999,"isDismesso":false},{"_id":"63a06ea9daceb65b1eebfbc3","lat":46.02990792989685,"long":11.292132223275663,"isDismesso":false},{"_id":"63a06ea9daceb65b1eebfbc5","lat":46.040078252642246,"long":11.324285932078455,"isDismesso":false},{"_id":"63a06ea9daceb65b1eebfbc7","lat":46.031938218609845,"long":11.345668245848335,"isDismesso":false},{"_id":"63a06ea9daceb65b1eebfbc9","lat":46.05214556544899,"long":11.312366031863176,"isDismesso":false},{"_id":"63a06ea9daceb65b1eebfbcb","lat":46.0583678299831,"long":11.378265837776825,"isDismesso":false},{"_id":"63a06ea9daceb65b1eebfbcd","lat":46.04783801010235,"long":11.313387526146604,"isDismesso":false},{"_id":"63a06eaadaceb65b1eebfbcf","lat":46.04514760656119,"long":11.32179294028103,"isDismesso":false},{"_id":"63a06eaadaceb65b1eebfbd1","lat":46.04904131809364,"long":11.311391275170369,"isDismesso":false},{"_id":"63a06eaadaceb65b1eebfbd3","lat":46.0309362155219,"long":11.301413081838644,"isDismesso":false},{"_id":"63a06eaadaceb65b1eebfbd5","lat":46.030185232746256,"long":11.308953353343211,"isDismesso":false},{"_id":"63a06eaadaceb65b1eebfbd7","lat":46.047973258048465,"long":11.370006421552445,"isDismesso":false},{"_id":"63a06eaadaceb65b1eebfbd9","lat":46.03923713779968,"long":11.309640195048852,"isDismesso":false},{"_id":"63a06eaadaceb65b1eebfbdb","lat":46.035590235195784,"long":11.340644795578639,"isDismesso":false},{"_id":"63a06eaadaceb65b1eebfbdd","lat":46.03170104086753,"long":11.303618702603902,"isDismesso":false},{"_id":"63a06eaadaceb65b1eebfbdf","lat":46.05927231088211,"long":11.393266715159925,"isDismesso":false},{"_id":"63a06eabdaceb65b1eebfbe1","lat":46.04019456832214,"long":11.379203684041196,"isDismesso":false},{"_id":"63a06eabdaceb65b1eebfbe3","lat":46.03894669038353,"long":11.31888379298988,"isDismesso":false},{"_id":"63a06eabdaceb65b1eebfbe5","lat":46.04828018236145,"long":11.33334350379428,"isDismesso":false},{"_id":"63a06eabdaceb65b1eebfbe7","lat":46.0553881091693,"long":11.393888844149668,"isDismesso":false},{"_id":"63a06eabdaceb65b1eebfbe9","lat":46.02666139870172,"long":11.298862041489992,"isDismesso":false},{"_id":"63a06eabdaceb65b1eebfbeb","lat":46.03864866212435,"long":11.338110402911735,"isDismesso":false},{"_id":"63a06eabdaceb65b1eebfbed","lat":46.05882461686559,"long":11.378288652562556,"isDismesso":false},{"_id":"63a06eabdaceb65b1eebfbef","lat":46.04921947445515,"long":11.385579874419664,"isDismesso":false},{"_id":"63a06eabdaceb65b1eebfbf1","lat":46.04845606198012,"long":11.30339015031015,"isDismesso":false},{"_id":"63a06eabdaceb65b1eebfbf3","lat":46.04319858001359,"long":11.355520480674185,"isDismesso":false},{"_id":"63a06eacdaceb65b1eebfbf5","lat":46.04573931766787,"long":11.299735991675366,"isDismesso":false},{"_id":"63a06eacdaceb65b1eebfbf7","lat":46.04416634970148,"long":11.329541835361333,"isDismesso":false},{"_id":"63a06eacdaceb65b1eebfbf9","lat":46.04372403415251,"long":11.316677984892628,"isDismesso":false},{"_id":"63a06eacdaceb65b1eebfbfb","lat":46.0285339374022,"long":11.298237987595533,"isDismesso":false},{"_id":"63a06eacdaceb65b1eebfbfd","lat":46.036333672943094,"long":11.339337872277738,"isDismesso":false},{"_id":"63a06eacdaceb65b1eebfbff","lat":46.043040375900965,"long":11.374907278527328,"isDismesso":false},{"_id":"63a06eacdaceb65b1eebfc01","lat":46.05059183458505,"long":11.401581142455669,"isDismesso":false},{"_id":"63a06eacdaceb65b1eebfc03","lat":46.058727647765416,"long":11.396629129689096,"isDismesso":false},{"_id":"63a06eacdaceb65b1eebfc05","lat":46.03335935562144,"long":11.323964048804791,"isDismesso":false},{"_id":"63a06eaddaceb65b1eebfc07","lat":46.046464777708586,"long":11.381282993314166,"isDismesso":false},{"_id":"63a06eaddaceb65b1eebfc09","lat":46.03003576673172,"long":11.28229570399634,"isDismesso":false},{"_id":"63a06eaddaceb65b1eebfc0b","lat":46.04090676443227,"long":11.369594092071065,"isDismesso":false},{"_id":"63a06eaddaceb65b1eebfc0d","lat":46.0495248568865,"long":11.38519319845974,"isDismesso":false},{"_id":"63a06eaddaceb65b1eebfc0f","lat":46.03261528070944,"long":11.334710695993207,"isDismesso":false},{"_id":"63a06eaddaceb65b1eebfc11","lat":46.03096839537439,"long":11.359157777017069,"isDismesso":false},{"_id":"63a06eaddaceb65b1eebfc13","lat":46.04779739434117,"long":11.312077242112757,"isDismesso":false},{"_id":"63a06eaddaceb65b1eebfc15","lat":46.04858343174301,"long":11.358596666765152,"isDismesso":false},{"_id":"63a06eaddaceb65b1eebfc17","lat":46.05176160898773,"long":11.292734610593865,"isDismesso":false},{"_id":"63a06eaedaceb65b1eebfc19","lat":46.037347928869764,"long":11.315753856257158,"isDismesso":false},{"_id":"63a06eaedaceb65b1eebfc1b","lat":46.04491642045998,"long":11.30284544672241,"isDismesso":false},{"_id":"63a06eaedaceb65b1eebfc1d","lat":46.0352230990139,"long":11.291100412640736,"isDismesso":false},{"_id":"63a06eaedaceb65b1eebfc1f","lat":46.04423081650262,"long":11.304736738265586,"isDismesso":false},{"_id":"63a06eaedaceb65b1eebfc21","lat":46.036177541300816,"long":11.322827859901784,"isDismesso":false},{"_id":"63a06eaedaceb65b1eebfc23","lat":46.05329504209317,"long":11.3815370212994,"isDismesso":false},{"_id":"63a06eaedaceb65b1eebfc25","lat":46.03989030903115,"long":11.305516164276789,"isDismesso":false},{"_id":"63a06eaedaceb65b1eebfc27","lat":46.048995635348504,"long":11.35356289690361,"isDismesso":false},{"_id":"63a06eaedaceb65b1eebfc29","lat":46.05425474081944,"long":11.365595214232993,"isDismesso":false},{"_id":"63a06eafdaceb65b1eebfc2b","lat":46.034226319895936,"long":11.361703245308675,"isDismesso":false},{"_id":"63a06eafdaceb65b1eebfc2d","lat":46.03655152035954,"long":11.301694691064508,"isDismesso":false},{"_id":"63a06eafdaceb65b1eebfc2f","lat":46.04227698374291,"long":11.321265205259076,"isDismesso":false},{"_id":"63a06eafdaceb65b1eebfc31","lat":46.03762274689149,"long":11.372545934686647,"isDismesso":false},{"_id":"63a06eafdaceb65b1eebfc33","lat":46.048649317360905,"long":11.339303493085788,"isDismesso":false},{"_id":"63a06eafdaceb65b1eebfc35","lat":46.03372814819041,"long":11.366583468744855,"isDismesso":false},{"_id":"63a06eafdaceb65b1eebfc37","lat":46.04196390004238,"long":11.325065262484689,"isDismesso":false},{"_id":"63a06eb0daceb65b1eebfc39","lat":46.0367294390498,"long":11.326115275125135,"isDismesso":false},{"_id":"63a06eb0daceb65b1eebfc3b","lat":46.04221024532492,"long":11.372693475144686,"isDismesso":false},{"_id":"63a06eb0daceb65b1eebfc3d","lat":46.04884364282058,"long":11.31437469717891,"isDismesso":false},{"_id":"63a06eb0daceb65b1eebfc3f","lat":46.03156327091202,"long":11.330850462315876,"isDismesso":false},{"_id":"63a06eb0daceb65b1eebfc41","lat":46.04520963242253,"long":11.304345535181064,"isDismesso":false},{"_id":"63a06eb0daceb65b1eebfc43","lat":46.051467406870806,"long":11.354054043086176,"isDismesso":false},{"_id":"63a06eb0daceb65b1eebfc45","lat":46.063196049881014,"long":11.3859645588964,"isDismesso":false},{"_id":"63a06eb0daceb65b1eebfc47","lat":46.027418594507594,"long":11.329336027934179,"isDismesso":false},{"_id":"63a06eb0daceb65b1eebfc49","lat":46.03819734142962,"long":11.284140245633926,"isDismesso":false},{"_id":"63a06eb1daceb65b1eebfc4b","lat":46.04665948437251,"long":11.358814097435717,"isDismesso":false},{"_id":"63a06eb1daceb65b1eebfc4d","lat":46.04423498813955,"long":11.306137883819858,"isDismesso":false},{"_id":"63a06eb1daceb65b1eebfc4f","lat":46.02370530249751,"long":11.310713283758952,"isDismesso":false},{"_id":"63a06eb1daceb65b1eebfc51","lat":46.03030002332271,"long":11.3590733370922,"isDismesso":false},{"_id":"63a06eb1daceb65b1eebfc53","lat":46.050391972346745,"long":11.307802922861113,"isDismesso":false},{"_id":"63a06eb1daceb65b1eebfc55","lat":46.03508088882589,"long":11.326480177712993,"isDismesso":false},{"_id":"63a06eb1daceb65b1eebfc57","lat":46.04579900184261,"long":11.308805929493863,"isDismesso":false},{"_id":"63a06eb1daceb65b1eebfc59","lat":46.02663026827938,"long":11.300172170894925,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc5b","lat":46.033845151438214,"long":11.33560027347443,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc5d","lat":46.048326370813896,"long":11.344406572064269,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc5f","lat":46.03764950799169,"long":11.35531834180913,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc61","lat":46.06268269126725,"long":11.384715323595895,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc63","lat":46.04647548389751,"long":11.389377043302595,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc65","lat":46.05978140438527,"long":11.39455165302534,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc67","lat":46.0568261907914,"long":11.382725645903118,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc69","lat":46.03442782014631,"long":11.291344818742035,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc6b","lat":46.040545806663964,"long":11.380238219745882,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc6d","lat":46.04770195141827,"long":11.343241627889789,"isDismesso":false},{"_id":"63a06eb2daceb65b1eebfc6f","lat":46.04176359902584,"long":11.377307098258726,"isDismesso":false},{"_id":"63a06eb3daceb65b1eebfc71","lat":46.05439191094894,"long":11.401115317302272,"isDismesso":false},{"_id":"63a06eb3daceb65b1eebfc73","lat":46.04991691478652,"long":11.38483308593438,"isDismesso":false},{"_id":"63a06eb3daceb65b1eebfc75","lat":46.04957626894701,"long":11.370728222501977,"isDismesso":false},{"_id":"63a06eb3daceb65b1eebfc77","lat":46.031703670076304,"long":11.352526287103224,"isDismesso":false},{"_id":"63a06eb3daceb65b1eebfc79","lat":46.0296764833061,"long":11.329694444573104,"isDismesso":false},{"_id":"63a06eb3daceb65b1eebfc7b","lat":46.03221032347648,"long":11.30786143322461,"isDismesso":false},{"_id":"63a06eb3daceb65b1eebfc7d","lat":46.03505054020443,"long":11.315447909507549,"isDismesso":false},{"_id":"63a06eb3daceb65b1eebfc7f","lat":46.03934612476385,"long":11.3042796131087,"isDismesso":false},{"_id":"63a06eb3daceb65b1eebfc81","lat":46.04716838033032,"long":11.300995217768563,"isDismesso":false},{"_id":"63a06eb4daceb65b1eebfc83","lat":46.04123625119097,"long":11.332830492037495,"isDismesso":false},{"_id":"63a06eb4daceb65b1eebfc85","lat":46.048175104423564,"long":11.336808242714627,"isDismesso":false},{"_id":"63a06eb4daceb65b1eebfc87","lat":46.058093503381194,"long":11.380197757721778,"isDismesso":false},{"_id":"63a06eb4daceb65b1eebfc89","lat":46.05022800599594,"long":11.358398198807055,"isDismesso":false},{"_id":"63a06eb4daceb65b1eebfc8b","lat":46.03672297508424,"long":11.329753317697511,"isDismesso":false},{"_id":"63a06eb4daceb65b1eebfc8d","lat":46.03793631432113,"long":11.293031768200636,"isDismesso":false},{"_id":"63a06eb4daceb65b1eebfc8f","lat":46.03425219489453,"long":11.284146236329025,"isDismesso":false},{"_id":"63a06eb4daceb65b1eebfc91","lat":46.03478183888418,"long":11.303250115110995,"isDismesso":false},{"_id":"63a06eb4daceb65b1eebfc93","lat":46.02770060499683,"long":11.28009259666326,"isDismesso":false},{"_id":"63a06eb4daceb65b1eebfc95","lat":46.05322956381891,"long":11.309988757684897,"isDismesso":false},{"_id":"63a06eb5daceb65b1eebfc97","lat":46.02548139182809,"long":11.279091906698328,"isDismesso":false},{"_id":"63a06eb5daceb65b1eebfc99","lat":46.03143682272215,"long":11.304322860465337,"isDismesso":false},{"_id":"63a06eb5daceb65b1eebfc9b","lat":46.05047509886427,"long":11.289760426493702,"isDismesso":false},{"_id":"63a06eb5daceb65b1eebfc9d","lat":46.0257686854284,"long":11.29689178196273,"isDismesso":false},{"_id":"63a06eb5daceb65b1eebfc9f","lat":46.04789481290788,"long":11.29646476411842,"isDismesso":false},{"_id":"63a06eb5daceb65b1eebfca1","lat":46.05145504548953,"long":11.361757878191593,"isDismesso":false},{"_id":"63a06eb5daceb65b1eebfca3","lat":46.02813144501987,"long":11.346686601389761,"isDismesso":false},{"_id":"63a06eb5daceb65b1eebfca5","lat":46.03589611573878,"long":11.375890569040148,"isDismesso":false},{"_id":"63a06eb5daceb65b1eebfca7","lat":46.0426679159802,"long":11.358468843977551,"isDismesso":false},{"_id":"63a06eb6daceb65b1eebfca9","lat":46.02594105851435,"long":11.282152784854679,"isDismesso":false},{"_id":"63a06eb6daceb65b1eebfcab","lat":46.03111866538073,"long":11.328483445363405,"isDismesso":false},{"_id":"63a06eb6daceb65b1eebfcad","lat":46.051286824034904,"long":11.389136126790202,"isDismesso":false},{"_id":"63a06eb6daceb65b1eebfcaf","lat":46.04546878761545,"long":11.3027906459431,"isDismesso":false},{"_id":"63a06eb6daceb65b1eebfcb1","lat":46.02888196870715,"long":11.281544596172571,"isDismesso":false},{"_id":"63a06eb6daceb65b1eebfcb3","lat":46.032760546588875,"long":11.27562581000736,"isDismesso":false},{"_id":"63a06eb6daceb65b1eebfcb5","lat":46.04919849331042,"long":11.341021774438785,"isDismesso":false},{"_id":"63a06eb6daceb65b1eebfcb7","lat":46.05695465960976,"long":11.392263954239388,"isDismesso":false},{"_id":"63a06eb7daceb65b1eebfcb9","lat":46.043529207152716,"long":11.37555335022086,"isDismesso":false},{"_id":"63a06eb7daceb65b1eebfcbb","lat":46.04494087471399,"long":11.373997818463794,"isDismesso":false},{"_id":"63a06eb7daceb65b1eebfcbd","lat":46.04351266547035,"long":11.360232551352563,"isDismesso":false},{"_id":"63a06eb7daceb65b1eebfcbf","lat":46.02746965757278,"long":11.311767934594727,"isDismesso":false},{"_id":"63a06eb7daceb65b1eebfcc1","lat":46.06217297048029,"long":11.382261455174188,"isDismesso":false},{"_id":"63a06eb7daceb65b1eebfcc3","lat":46.053074922521304,"long":11.368407705803438,"isDismesso":false},{"_id":"63a06eb8daceb65b1eebfcc5","lat":46.03277265805045,"long":11.338900512856961,"isDismesso":false},{"_id":"63a06eb8daceb65b1eebfcc7","lat":46.04557467694453,"long":11.378442898924416,"isDismesso":false},{"_id":"63a06eb8daceb65b1eebfcc9","lat":46.03544263133922,"long":11.34543678442739,"isDismesso":false},{"_id":"63a06eb8daceb65b1eebfccb","lat":46.03524553348473,"long":11.336003631541667,"isDismesso":false},{"_id":"63a06eb8daceb65b1eebfccd","lat":46.028652041315034,"long":11.348174936469697,"isDismesso":false},{"_id":"63a06eb8daceb65b1eebfccf","lat":46.03722381431377,"long":11.37096644495954,"isDismesso":false},{"_id":"63a06eb8daceb65b1eebfcd1","lat":46.031515787745036,"long":11.345135648490746,"isDismesso":false},{"_id":"63a06eb8daceb65b1eebfcd3","lat":46.04637742595675,"long":11.357563648651162,"isDismesso":false},{"_id":"63a06eb9daceb65b1eebfcd5","lat":46.047422781296824,"long":11.394141384866499,"isDismesso":false},{"_id":"63a06eb9daceb65b1eebfcd7","lat":46.04551434009384,"long":11.357392144596306,"isDismesso":false},{"_id":"63a06eb9daceb65b1eebfcd9","lat":46.04457945879017,"long":11.377967251646414,"isDismesso":false},{"_id":"63a06eb9daceb65b1eebfcdb","lat":46.03484143259432,"long":11.273435586225434,"isDismesso":false},{"_id":"63a06eb9daceb65b1eebfcdd","lat":46.04631764563529,"long":11.334114042682744,"isDismesso":false},{"_id":"63a06eb9daceb65b1eebfcdf","lat":46.05111051478222,"long":11.385792077348468,"isDismesso":false},{"_id":"63a06eb9daceb65b1eebfce1","lat":46.02736521466503,"long":11.284896979526117,"isDismesso":false},{"_id":"63a06ebadaceb65b1eebfce3","lat":46.02954733531859,"long":11.337095226067516,"isDismesso":false}],"snapshots":["2022-12-12T00:00:00.000Z","2022-12-12T00:05:00.000Z","2022-12-12T00:10:00.000Z","2022-12-12T00:15:00.000Z","2022-12-12T00:20:00.000Z","2022-12-12T00:25:00.000Z","2022-12-12T00:30:00.000Z","2022-12-12T00:35:00.000Z","2022-12-12T00:40:00.000Z","2022-12-12T00:45:00.000Z"]})
  })
  test('GET /myAcc/impianti/:selImpId/heatmap No such impianto for this user', () => {
    return request(app).get('/myAcc/impianti/non_existing_imp_id/heatmap')
    .set('x-access-token', genToken(
      'mario.rossi@gmail.com',
      '639f1c3274aef65fb510cb79',
      'cliente'
      ))
    .send()
    .expect(StatusCodes.NOT_FOUND)
    .expect('x-token-status', 'valid')
    .expect({  
      code: 1,
      message: 'Error retrieving impianto - No such impianto for this user'
    })
  })
})

describe('GET /myAcc/impianti/:selImpId/snapshots/:selSnapTs', () => {
  test('GET /myAcc/impianti/:selImpId/snapshots/:selSnapTs No such impianto for this user', () => {
    return request(app).get('/myAcc/impianti/non_existing_imp_id/snapshots/1670803200000')
    .set('x-access-token', genToken(
      'mario.rossi@gmail.com',
      '639f1c3274aef65fb510cb79',
      'cliente'
      ))
    .send()
    .expect(StatusCodes.NOT_FOUND)
    .expect('x-token-status', 'valid')
    .expect({  
      code: 1,
      message: 'Error retrieving impianto - No such impianto for this user'
    })
  })
  test('GET /myAcc/impianti/:selImpId/snapshots/:selSnapTs Error retrieving misurazioni', () => {
    return request(app).get('/myAcc/impianti/639f2df174aef65fb510cb8f/snapshots/000000000000')
    .set('x-access-token', genToken(
      'mario.rossi@gmail.com',
      '639f1c3274aef65fb510cb79',
      'cliente'
      ))
    .send()
    .expect(StatusCodes.NOT_FOUND)
    .expect('x-token-status', 'valid')
    .expect({  
      code: 3,
      message: 'Error retrieving snapshot - No such snapshot'
    })
  })
  test('GET /myAcc/impianti/:selImpId/snapshots/:selSnapTs Ok', () => {
    return request(app).get('/myAcc/impianti/639f2df174aef65fb510cb8f/snapshots/1670803200000')
    .set('x-access-token', genToken(
      'mario.rossi@gmail.com',
      '639f1c3274aef65fb510cb79',
      'cliente'
      ))
    .send()
    .expect(StatusCodes.OK)
    .expect('x-token-status', 'valid')
    .expect([{"sensore":"63a06ea2daceb65b1eebfb55","valori":{"temp":14,"hum_rel":69,"CO2":1814,"O2":2042,"tvoc":519}},{"sensore":"63a06ea2daceb65b1eebfb57","valori":{"temp":18,"hum_rel":60,"CO2":2233,"O2":2304,"tvoc":1997}},{"sensore":"63a06ea2daceb65b1eebfb59","valori":{"temp":13,"hum_rel":84,"CO2":1146,"O2":2496,"tvoc":2318}},{"sensore":"63a06ea2daceb65b1eebfb5b","valori":{"temp":11,"hum_rel":41,"CO2":1747,"O2":2353,"tvoc":19498}},{"sensore":"63a06ea2daceb65b1eebfb5d","valori":{"temp":21,"hum_rel":30,"CO2":467,"O2":469,"tvoc":245}},{"sensore":"63a06ea2daceb65b1eebfb5f","valori":{"temp":13,"hum_rel":12,"CO2":497,"O2":1244,"tvoc":533}},{"sensore":"63a06ea3daceb65b1eebfb61","valori":{"temp":24,"hum_rel":68,"CO2":895,"O2":919,"tvoc":2022}},{"sensore":"63a06ea3daceb65b1eebfb63","valori":{"temp":47,"hum_rel":67,"CO2":2692,"O2":2547,"tvoc":2185}},{"sensore":"63a06ea3daceb65b1eebfb65","valori":{"temp":12,"hum_rel":42,"CO2":2685,"O2":2224,"tvoc":604}},{"sensore":"63a06ea3daceb65b1eebfb67","valori":{"temp":20,"hum_rel":34,"CO2":2485,"O2":723,"tvoc":823}},{"sensore":"63a06ea3daceb65b1eebfb69","valori":{"temp":11,"hum_rel":59,"CO2":1196,"O2":1743,"tvoc":870}},{"sensore":"63a06ea3daceb65b1eebfb6b","valori":{"temp":17,"hum_rel":64,"CO2":1242,"O2":2964,"tvoc":1979}},{"sensore":"63a06ea3daceb65b1eebfb6d","valori":{"temp":25,"hum_rel":96,"CO2":2858,"O2":1199,"tvoc":528}},{"sensore":"63a06ea3daceb65b1eebfb6f","valori":{"temp":26,"hum_rel":37,"CO2":493,"O2":441,"tvoc":973}},{"sensore":"63a06ea3daceb65b1eebfb71","valori":{"temp":13,"hum_rel":31,"CO2":2649,"O2":2469,"tvoc":1007}},{"sensore":"63a06ea4daceb65b1eebfb73","valori":{"temp":33,"hum_rel":97,"CO2":471,"O2":1347,"tvoc":2757}},{"sensore":"63a06ea4daceb65b1eebfb75","valori":{"temp":22,"hum_rel":59,"CO2":2994,"O2":564,"tvoc":660}},{"sensore":"63a06ea4daceb65b1eebfb77","valori":{"temp":25,"hum_rel":75,"CO2":1738,"O2":623,"tvoc":755}},{"sensore":"63a06ea4daceb65b1eebfb79","valori":{"temp":24,"hum_rel":65,"CO2":1035,"O2":1627,"tvoc":1948}},{"sensore":"63a06ea4daceb65b1eebfb7b","valori":{"temp":15,"hum_rel":87,"CO2":1511,"O2":2655,"tvoc":2066}},{"sensore":"63a06ea4daceb65b1eebfb7d","valori":{"temp":24,"hum_rel":53,"CO2":1616,"O2":2241,"tvoc":1148}},{"sensore":"63a06ea4daceb65b1eebfb7f","valori":{"temp":23,"hum_rel":64,"CO2":2748,"O2":2320,"tvoc":657}},{"sensore":"63a06ea4daceb65b1eebfb81","valori":{"temp":24,"hum_rel":99,"CO2":2621,"O2":2587,"tvoc":2816}},{"sensore":"63a06ea4daceb65b1eebfb83","valori":{"temp":15,"hum_rel":53,"CO2":1730,"O2":1175,"tvoc":2956}},{"sensore":"63a06ea4daceb65b1eebfb85","valori":{"temp":15,"hum_rel":57,"CO2":959,"O2":1039,"tvoc":2830}},{"sensore":"63a06ea4daceb65b1eebfb87","valori":{"temp":12,"hum_rel":65,"CO2":693,"O2":2203,"tvoc":2560}},{"sensore":"63a06ea4daceb65b1eebfb89","valori":{"temp":27,"hum_rel":53,"CO2":1441,"O2":973,"tvoc":26963}},{"sensore":"63a06ea5daceb65b1eebfb8b","valori":{"temp":41,"hum_rel":49,"CO2":2284,"O2":2580,"tvoc":2154}},{"sensore":"63a06ea5daceb65b1eebfb8d","valori":{"temp":36,"hum_rel":76,"CO2":1354,"O2":1556,"tvoc":2811}},{"sensore":"63a06ea5daceb65b1eebfb8f","valori":{"temp":13,"hum_rel":96,"CO2":2473,"O2":2628,"tvoc":568}},{"sensore":"63a06ea5daceb65b1eebfb91","valori":{"temp":22,"hum_rel":60,"CO2":2332,"O2":2844,"tvoc":458}},{"sensore":"63a06ea5daceb65b1eebfb93","valori":{"temp":15,"hum_rel":39,"CO2":1020,"O2":2097,"tvoc":1464}},{"sensore":"63a06ea6daceb65b1eebfb95","valori":{"temp":22,"hum_rel":41,"CO2":1947,"O2":1123,"tvoc":2968}},{"sensore":"63a06ea6daceb65b1eebfb97","valori":{"temp":16,"hum_rel":52,"CO2":2987,"O2":2046,"tvoc":852}},{"sensore":"63a06ea6daceb65b1eebfb99","valori":{"temp":15,"hum_rel":37,"CO2":2075,"O2":15797,"tvoc":2036}},{"sensore":"63a06ea6daceb65b1eebfb9b","valori":{"temp":14,"hum_rel":100,"CO2":1807,"O2":440,"tvoc":940}},{"sensore":"63a06ea6daceb65b1eebfb9d","valori":{"temp":23,"hum_rel":57,"CO2":968,"O2":1885,"tvoc":792}},{"sensore":"63a06ea6daceb65b1eebfb9f","valori":{"temp":17,"hum_rel":75,"CO2":708,"O2":2567,"tvoc":26375}},{"sensore":"63a06ea6daceb65b1eebfba1","valori":{"temp":15,"hum_rel":12,"CO2":963,"O2":1349,"tvoc":2823}},{"sensore":"63a06ea6daceb65b1eebfba3","valori":{"temp":24,"hum_rel":12,"CO2":2462,"O2":1830,"tvoc":496}},{"sensore":"63a06ea6daceb65b1eebfba5","valori":{"temp":25,"hum_rel":69,"CO2":16054,"O2":2126,"tvoc":2943}},{"sensore":"63a06ea6daceb65b1eebfba7","valori":{"temp":30,"hum_rel":53,"CO2":976,"O2":842,"tvoc":766}},{"sensore":"63a06ea7daceb65b1eebfba9","valori":{"temp":28,"hum_rel":70,"CO2":949,"O2":2364,"tvoc":2922}},{"sensore":"63a06ea7daceb65b1eebfbab","valori":{"temp":23,"hum_rel":90,"CO2":2661,"O2":431,"tvoc":928}},{"sensore":"63a06ea7daceb65b1eebfbad","valori":{"temp":23,"hum_rel":52,"CO2":410,"O2":1504,"tvoc":2279}},{"sensore":"63a06ea7daceb65b1eebfbaf","valori":{"temp":25,"hum_rel":72,"CO2":856,"O2":453,"tvoc":2536}},{"sensore":"63a06ea7daceb65b1eebfbb1","valori":{"temp":24,"hum_rel":48,"CO2":1831,"O2":2817,"tvoc":463}},{"sensore":"63a06ea7daceb65b1eebfbb3","valori":{"temp":22,"hum_rel":63,"CO2":1510,"O2":1153,"tvoc":4449}},{"sensore":"63a06ea8daceb65b1eebfbb5","valori":{"temp":41,"hum_rel":71,"CO2":646,"O2":1243,"tvoc":2258}},{"sensore":"63a06ea8daceb65b1eebfbb7","valori":{"temp":42,"hum_rel":63,"CO2":691,"O2":1358,"tvoc":2110}},{"sensore":"63a06ea8daceb65b1eebfbb9","valori":{"temp":30,"hum_rel":74,"CO2":1262,"O2":2359,"tvoc":17233}},{"sensore":"63a06ea8daceb65b1eebfbbb","valori":{"temp":22,"hum_rel":100,"CO2":1670,"O2":2038,"tvoc":448}},{"sensore":"63a06ea8daceb65b1eebfbbd","valori":{"temp":20,"hum_rel":88,"CO2":617,"O2":2910,"tvoc":299}},{"sensore":"63a06ea8daceb65b1eebfbbf","valori":{"temp":12,"hum_rel":41,"CO2":876,"O2":2854,"tvoc":341}},{"sensore":"63a06ea9daceb65b1eebfbc1","valori":{"temp":39,"hum_rel":97,"CO2":2405,"O2":2410,"tvoc":1691}},{"sensore":"63a06ea9daceb65b1eebfbc3","valori":{"temp":17,"hum_rel":94,"CO2":753,"O2":906,"tvoc":1101}},{"sensore":"63a06ea9daceb65b1eebfbc5","valori":{"temp":13,"hum_rel":52,"CO2":1136,"O2":1614,"tvoc":153}},{"sensore":"63a06ea9daceb65b1eebfbc7","valori":{"temp":31,"hum_rel":75,"CO2":2845,"O2":2641,"tvoc":1815}},{"sensore":"63a06ea9daceb65b1eebfbc9","valori":{"temp":22,"hum_rel":30,"CO2":2038,"O2":1374,"tvoc":639}},{"sensore":"63a06ea9daceb65b1eebfbcb","valori":{"temp":43,"hum_rel":42,"CO2":496,"O2":2348,"tvoc":1820}},{"sensore":"63a06ea9daceb65b1eebfbcd","valori":{"temp":23,"hum_rel":94,"CO2":2814,"O2":1867,"tvoc":1803}},{"sensore":"63a06eaadaceb65b1eebfbcf","valori":{"temp":19,"hum_rel":43,"CO2":586,"O2":2245,"tvoc":2766}},{"sensore":"63a06eaadaceb65b1eebfbd1","valori":{"temp":27,"hum_rel":68,"CO2":957,"O2":1047,"tvoc":1226}},{"sensore":"63a06eaadaceb65b1eebfbd3","valori":{"temp":27,"hum_rel":34,"CO2":804,"O2":1006,"tvoc":1715}},{"sensore":"63a06eaadaceb65b1eebfbd5","valori":{"temp":29,"hum_rel":58,"CO2":1783,"O2":1592,"tvoc":918}},{"sensore":"63a06eaadaceb65b1eebfbd7","valori":{"temp":13,"hum_rel":72,"CO2":1352,"O2":1223,"tvoc":32}},{"sensore":"63a06eaadaceb65b1eebfbd9","valori":{"temp":19,"hum_rel":76,"CO2":1184,"O2":2930,"tvoc":21071}},{"sensore":"63a06eaadaceb65b1eebfbdb","valori":{"temp":16,"hum_rel":100,"CO2":2447,"O2":2127,"tvoc":797}},{"sensore":"63a06eaadaceb65b1eebfbdd","valori":{"temp":30,"hum_rel":86,"CO2":1005,"O2":1911,"tvoc":283}},{"sensore":"63a06eaadaceb65b1eebfbdf","valori":{"temp":14,"hum_rel":63,"CO2":2967,"O2":1787,"tvoc":1938}},{"sensore":"63a06eabdaceb65b1eebfbe1","valori":{"temp":17,"hum_rel":46,"CO2":1965,"O2":1177,"tvoc":1979}},{"sensore":"63a06eabdaceb65b1eebfbe3","valori":{"temp":26,"hum_rel":20,"CO2":2388,"O2":1740,"tvoc":2991}},{"sensore":"63a06eabdaceb65b1eebfbe5","valori":{"temp":12,"hum_rel":48,"CO2":417,"O2":542,"tvoc":2984}},{"sensore":"63a06eabdaceb65b1eebfbe7","valori":{"temp":15,"hum_rel":81,"CO2":5848,"O2":2789,"tvoc":1381}},{"sensore":"63a06eabdaceb65b1eebfbe9","valori":{"temp":63,"hum_rel":64,"CO2":1891,"O2":1349,"tvoc":1053}},{"sensore":"63a06eabdaceb65b1eebfbeb","valori":{"temp":24,"hum_rel":90,"CO2":2366,"O2":1403,"tvoc":1140}},{"sensore":"63a06eabdaceb65b1eebfbed","valori":{"temp":27,"hum_rel":61,"CO2":12125,"O2":2019,"tvoc":2069}},{"sensore":"63a06eabdaceb65b1eebfbef","valori":{"temp":27,"hum_rel":35,"CO2":1318,"O2":1550,"tvoc":346}},{"sensore":"63a06eabdaceb65b1eebfbf1","valori":{"temp":32,"hum_rel":44,"CO2":406,"O2":2333,"tvoc":2992}},{"sensore":"63a06eabdaceb65b1eebfbf3","valori":{"temp":16,"hum_rel":64,"CO2":2801,"O2":1641,"tvoc":2810}},{"sensore":"63a06eacdaceb65b1eebfbf5","valori":{"temp":21,"hum_rel":11,"CO2":1089,"O2":1002,"tvoc":979}},{"sensore":"63a06eacdaceb65b1eebfbf7","valori":{"temp":19,"hum_rel":36,"CO2":2578,"O2":1466,"tvoc":2464}},{"sensore":"63a06eacdaceb65b1eebfbf9","valori":{"temp":27,"hum_rel":59,"CO2":2986,"O2":500,"tvoc":23815}},{"sensore":"63a06eacdaceb65b1eebfbfb","valori":{"temp":46,"hum_rel":75,"CO2":1107,"O2":2543,"tvoc":449}},{"sensore":"63a06eacdaceb65b1eebfbfd","valori":{"temp":28,"hum_rel":70,"CO2":1316,"O2":1396,"tvoc":501}},{"sensore":"63a06eacdaceb65b1eebfbff","valori":{"temp":27,"hum_rel":32,"CO2":1261,"O2":2387,"tvoc":786}},{"sensore":"63a06eacdaceb65b1eebfc01","valori":{"temp":11,"hum_rel":61,"CO2":1634,"O2":1468,"tvoc":1695}},{"sensore":"63a06eacdaceb65b1eebfc03","valori":{"temp":22,"hum_rel":78,"CO2":2916,"O2":1874,"tvoc":864}},{"sensore":"63a06eacdaceb65b1eebfc05","valori":{"temp":17,"hum_rel":25,"CO2":1079,"O2":1720,"tvoc":1490}},{"sensore":"63a06eaddaceb65b1eebfc07","valori":{"temp":28,"hum_rel":50,"CO2":1384,"O2":2458,"tvoc":25484}},{"sensore":"63a06eaddaceb65b1eebfc09","valori":{"temp":15,"hum_rel":49,"CO2":2037,"O2":1238,"tvoc":2983}},{"sensore":"63a06eaddaceb65b1eebfc0b","valori":{"temp":11,"hum_rel":64,"CO2":1087,"O2":528,"tvoc":1343}},{"sensore":"63a06eaddaceb65b1eebfc0d","valori":{"temp":29,"hum_rel":80,"CO2":2104,"O2":930,"tvoc":488}},{"sensore":"63a06eaddaceb65b1eebfc0f","valori":{"temp":22,"hum_rel":54,"CO2":1822,"O2":2913,"tvoc":2885}},{"sensore":"63a06eaddaceb65b1eebfc11","valori":{"temp":19,"hum_rel":86,"CO2":1710,"O2":1756,"tvoc":2156}},{"sensore":"63a06eaddaceb65b1eebfc13","valori":{"temp":15,"hum_rel":50,"CO2":966,"O2":28040,"tvoc":3573}},{"sensore":"63a06eaddaceb65b1eebfc15","valori":{"temp":26,"hum_rel":36,"CO2":1349,"O2":2644,"tvoc":2665}},{"sensore":"63a06eaddaceb65b1eebfc17","valori":{"temp":27,"hum_rel":36,"CO2":23853,"O2":1926,"tvoc":1778}},{"sensore":"63a06eaedaceb65b1eebfc19","valori":{"temp":29,"hum_rel":39,"CO2":1904,"O2":2493,"tvoc":1930}},{"sensore":"63a06eaedaceb65b1eebfc1b","valori":{"temp":13,"hum_rel":79,"CO2":2715,"O2":12840,"tvoc":263}},{"sensore":"63a06eaedaceb65b1eebfc1d","valori":{"temp":25,"hum_rel":64,"CO2":2148,"O2":842,"tvoc":1696}},{"sensore":"63a06eaedaceb65b1eebfc1f","valori":{"temp":11,"hum_rel":84,"CO2":2509,"O2":2582,"tvoc":1336}},{"sensore":"63a06eaedaceb65b1eebfc21","valori":{"temp":32,"hum_rel":32,"CO2":1806,"O2":2579,"tvoc":1731}},{"sensore":"63a06eaedaceb65b1eebfc23","valori":{"temp":21,"hum_rel":70,"CO2":21387,"O2":2036,"tvoc":551}},{"sensore":"63a06eaedaceb65b1eebfc25","valori":{"temp":12,"hum_rel":38,"CO2":2686,"O2":796,"tvoc":1549}},{"sensore":"63a06eaedaceb65b1eebfc27","valori":{"temp":30,"hum_rel":25,"CO2":2982,"O2":5711,"tvoc":338}},{"sensore":"63a06eaedaceb65b1eebfc29","valori":{"temp":14,"hum_rel":44,"CO2":2189,"O2":1250,"tvoc":1129}},{"sensore":"63a06eafdaceb65b1eebfc2b","valori":{"temp":24,"hum_rel":83,"CO2":2813,"O2":1404,"tvoc":2582}},{"sensore":"63a06eafdaceb65b1eebfc2d","valori":{"temp":24,"hum_rel":53,"CO2":487,"O2":2278,"tvoc":2018}},{"sensore":"63a06eafdaceb65b1eebfc2f","valori":{"temp":29,"hum_rel":90,"CO2":2658,"O2":868,"tvoc":414}},{"sensore":"63a06eafdaceb65b1eebfc31","valori":{"temp":26,"hum_rel":72,"CO2":2343,"O2":2803,"tvoc":750}},{"sensore":"63a06eafdaceb65b1eebfc33","valori":{"temp":29,"hum_rel":61,"CO2":2730,"O2":2853,"tvoc":810}},{"sensore":"63a06eafdaceb65b1eebfc35","valori":{"temp":49,"hum_rel":49,"CO2":544,"O2":2899,"tvoc":2498}},{"sensore":"63a06eafdaceb65b1eebfc37","valori":{"temp":39,"hum_rel":53,"CO2":1370,"O2":1776,"tvoc":2160}},{"sensore":"63a06eb0daceb65b1eebfc39","valori":{"temp":25,"hum_rel":61,"CO2":1532,"O2":1942,"tvoc":2643}},{"sensore":"63a06eb0daceb65b1eebfc3b","valori":{"temp":24,"hum_rel":33,"CO2":2412,"O2":2801,"tvoc":18238}},{"sensore":"63a06eb0daceb65b1eebfc3d","valori":{"temp":49,"hum_rel":71,"CO2":639,"O2":523,"tvoc":665}},{"sensore":"63a06eb0daceb65b1eebfc3f","valori":{"temp":28,"hum_rel":94,"CO2":829,"O2":2862,"tvoc":20506}},{"sensore":"63a06eb0daceb65b1eebfc41","valori":{"temp":22,"hum_rel":68,"CO2":2751,"O2":1955,"tvoc":1321}},{"sensore":"63a06eb0daceb65b1eebfc43","valori":{"temp":19,"hum_rel":93,"CO2":1053,"O2":695,"tvoc":2681}},{"sensore":"63a06eb0daceb65b1eebfc45","valori":{"temp":17,"hum_rel":59,"CO2":2049,"O2":1213,"tvoc":26502}},{"sensore":"63a06eb0daceb65b1eebfc47","valori":{"temp":17,"hum_rel":83,"CO2":2783,"O2":1698,"tvoc":1453}},{"sensore":"63a06eb0daceb65b1eebfc49","valori":{"temp":45,"hum_rel":84,"CO2":2229,"O2":1211,"tvoc":921}},{"sensore":"63a06eb1daceb65b1eebfc4b","valori":{"temp":41,"hum_rel":69,"CO2":2916,"O2":1230,"tvoc":2805}},{"sensore":"63a06eb1daceb65b1eebfc4d","valori":{"temp":12,"hum_rel":92,"CO2":1868,"O2":2807,"tvoc":1981}},{"sensore":"63a06eb1daceb65b1eebfc4f","valori":{"temp":17,"hum_rel":58,"CO2":573,"O2":445,"tvoc":2076}},{"sensore":"63a06eb1daceb65b1eebfc51","valori":{"temp":12,"hum_rel":52,"CO2":411,"O2":480,"tvoc":1243}},{"sensore":"63a06eb1daceb65b1eebfc53","valori":{"temp":13,"hum_rel":65,"CO2":896,"O2":1752,"tvoc":174}},{"sensore":"63a06eb1daceb65b1eebfc55","valori":{"temp":12,"hum_rel":99,"CO2":1766,"O2":2455,"tvoc":1289}},{"sensore":"63a06eb1daceb65b1eebfc57","valori":{"temp":28,"hum_rel":81,"CO2":727,"O2":1164,"tvoc":11338}},{"sensore":"63a06eb1daceb65b1eebfc59","valori":{"temp":27,"hum_rel":61,"CO2":2593,"O2":28059,"tvoc":1384}},{"sensore":"63a06eb2daceb65b1eebfc5b","valori":{"temp":22,"hum_rel":15,"CO2":2309,"O2":1039,"tvoc":2178}},{"sensore":"63a06eb2daceb65b1eebfc5d","valori":{"temp":29,"hum_rel":76,"CO2":719,"O2":1917,"tvoc":2695}},{"sensore":"63a06eb2daceb65b1eebfc5f","valori":{"temp":24,"hum_rel":87,"CO2":2362,"O2":1691,"tvoc":2757}},{"sensore":"63a06eb2daceb65b1eebfc61","valori":{"temp":32,"hum_rel":98,"CO2":938,"O2":2809,"tvoc":596}},{"sensore":"63a06eb2daceb65b1eebfc63","valori":{"temp":14,"hum_rel":37,"CO2":2794,"O2":669,"tvoc":688}},{"sensore":"63a06eb2daceb65b1eebfc65","valori":{"temp":14,"hum_rel":65,"CO2":671,"O2":1252,"tvoc":17317}},{"sensore":"63a06eb2daceb65b1eebfc67","valori":{"temp":25,"hum_rel":41,"CO2":2424,"O2":2032,"tvoc":980}},{"sensore":"63a06eb2daceb65b1eebfc69","valori":{"temp":29,"hum_rel":83,"CO2":1166,"O2":2615,"tvoc":190}},{"sensore":"63a06eb2daceb65b1eebfc6b","valori":{"temp":25,"hum_rel":82,"CO2":1925,"O2":870,"tvoc":10907}},{"sensore":"63a06eb2daceb65b1eebfc6d","valori":{"temp":21,"hum_rel":31,"CO2":573,"O2":1379,"tvoc":432}},{"sensore":"63a06eb2daceb65b1eebfc6f","valori":{"temp":45,"hum_rel":75,"CO2":2607,"O2":2131,"tvoc":2662}},{"sensore":"63a06eb3daceb65b1eebfc71","valori":{"temp":23,"hum_rel":77,"CO2":1876,"O2":2258,"tvoc":141}},{"sensore":"63a06eb3daceb65b1eebfc73","valori":{"temp":21,"hum_rel":48,"CO2":1623,"O2":1576,"tvoc":193}},{"sensore":"63a06eb3daceb65b1eebfc75","valori":{"temp":16,"hum_rel":49,"CO2":2799,"O2":719,"tvoc":385}},{"sensore":"63a06eb3daceb65b1eebfc77","valori":{"temp":24,"hum_rel":74,"CO2":967,"O2":1748,"tvoc":2426}},{"sensore":"63a06eb3daceb65b1eebfc79","valori":{"temp":24,"hum_rel":51,"CO2":1814,"O2":2130,"tvoc":2493}},{"sensore":"63a06eb3daceb65b1eebfc7b","valori":{"temp":46,"hum_rel":81,"CO2":524,"O2":18126,"tvoc":1893}},{"sensore":"63a06eb3daceb65b1eebfc7d","valori":{"temp":19,"hum_rel":78,"CO2":919,"O2":2131,"tvoc":533}},{"sensore":"63a06eb3daceb65b1eebfc7f","valori":{"temp":15,"hum_rel":8,"CO2":1689,"O2":2131,"tvoc":472}},{"sensore":"63a06eb3daceb65b1eebfc81","valori":{"temp":25,"hum_rel":37,"CO2":1540,"O2":449,"tvoc":2485}},{"sensore":"63a06eb4daceb65b1eebfc83","valori":{"temp":13,"hum_rel":73,"CO2":1714,"O2":661,"tvoc":1061}},{"sensore":"63a06eb4daceb65b1eebfc85","valori":{"temp":19,"hum_rel":82,"CO2":478,"O2":909,"tvoc":504}},{"sensore":"63a06eb4daceb65b1eebfc87","valori":{"temp":49,"hum_rel":53,"CO2":583,"O2":595,"tvoc":2522}},{"sensore":"63a06eb4daceb65b1eebfc89","valori":{"temp":22,"hum_rel":85,"CO2":1650,"O2":1562,"tvoc":1455}},{"sensore":"63a06eb4daceb65b1eebfc8b","valori":{"temp":15,"hum_rel":38,"CO2":1474,"O2":1871,"tvoc":94}},{"sensore":"63a06eb4daceb65b1eebfc8d","valori":{"temp":21,"hum_rel":45,"CO2":2824,"O2":1048,"tvoc":1215}},{"sensore":"63a06eb4daceb65b1eebfc8f","valori":{"temp":18,"hum_rel":87,"CO2":1175,"O2":2546,"tvoc":1304}},{"sensore":"63a06eb4daceb65b1eebfc91","valori":{"temp":45,"hum_rel":90,"CO2":418,"O2":2434,"tvoc":964}},{"sensore":"63a06eb4daceb65b1eebfc93","valori":{"temp":12,"hum_rel":57,"CO2":728,"O2":2298,"tvoc":2222}},{"sensore":"63a06eb4daceb65b1eebfc95","valori":{"temp":35,"hum_rel":96,"CO2":2446,"O2":1803,"tvoc":1690}},{"sensore":"63a06eb5daceb65b1eebfc97","valori":{"temp":16,"hum_rel":90,"CO2":2097,"O2":1164,"tvoc":1608}},{"sensore":"63a06eb5daceb65b1eebfc99","valori":{"temp":30,"hum_rel":97,"CO2":951,"O2":2161,"tvoc":2888}},{"sensore":"63a06eb5daceb65b1eebfc9b","valori":{"temp":19,"hum_rel":95,"CO2":21885,"O2":1211,"tvoc":82}},{"sensore":"63a06eb5daceb65b1eebfc9d","valori":{"temp":27,"hum_rel":32,"CO2":639,"O2":645,"tvoc":2473}},{"sensore":"63a06eb5daceb65b1eebfc9f","valori":{"temp":11,"hum_rel":59,"CO2":2814,"O2":522,"tvoc":2623}},{"sensore":"63a06eb5daceb65b1eebfca1","valori":{"temp":25,"hum_rel":64,"CO2":2029,"O2":1746,"tvoc":39}},{"sensore":"63a06eb5daceb65b1eebfca3","valori":{"temp":23,"hum_rel":6,"CO2":2595,"O2":2163,"tvoc":18206}},{"sensore":"63a06eb5daceb65b1eebfca5","valori":{"temp":37,"hum_rel":98,"CO2":1862,"O2":970,"tvoc":1865}},{"sensore":"63a06eb5daceb65b1eebfca7","valori":{"temp":18,"hum_rel":91,"CO2":1295,"O2":1465,"tvoc":2951}},{"sensore":"63a06eb6daceb65b1eebfca9","valori":{"temp":27,"hum_rel":30,"CO2":2866,"O2":1490,"tvoc":2021}},{"sensore":"63a06eb6daceb65b1eebfcab","valori":{"temp":24,"hum_rel":49,"CO2":1910,"O2":2449,"tvoc":382}},{"sensore":"63a06eb6daceb65b1eebfcad","valori":{"temp":49,"hum_rel":97,"CO2":583,"O2":1024,"tvoc":2730}},{"sensore":"63a06eb6daceb65b1eebfcaf","valori":{"temp":13,"hum_rel":73,"CO2":2753,"O2":560,"tvoc":2036}},{"sensore":"63a06eb6daceb65b1eebfcb1","valori":{"temp":22,"hum_rel":65,"CO2":2951,"O2":842,"tvoc":2296}},{"sensore":"63a06eb6daceb65b1eebfcb3","valori":{"temp":34,"hum_rel":45,"CO2":863,"O2":1503,"tvoc":2843}},{"sensore":"63a06eb6daceb65b1eebfcb5","valori":{"temp":38,"hum_rel":38,"CO2":1438,"O2":2297,"tvoc":1234}},{"sensore":"63a06eb6daceb65b1eebfcb7","valori":{"temp":20,"hum_rel":98,"CO2":2979,"O2":600,"tvoc":2552}},{"sensore":"63a06eb7daceb65b1eebfcb9","valori":{"temp":15,"hum_rel":25,"CO2":2456,"O2":2946,"tvoc":2154}},{"sensore":"63a06eb7daceb65b1eebfcbb","valori":{"temp":23,"hum_rel":87,"CO2":2139,"O2":1353,"tvoc":1855}},{"sensore":"63a06eb7daceb65b1eebfcbd","valori":{"temp":14,"hum_rel":67,"CO2":2091,"O2":2818,"tvoc":1504}},{"sensore":"63a06eb7daceb65b1eebfcbf","valori":{"temp":28,"hum_rel":95,"CO2":2169,"O2":1413,"tvoc":1248}},{"sensore":"63a06eb7daceb65b1eebfcc1","valori":{"temp":29,"hum_rel":63,"CO2":678,"O2":1386,"tvoc":217}},{"sensore":"63a06eb7daceb65b1eebfcc3","valori":{"temp":25,"hum_rel":68,"CO2":2744,"O2":453,"tvoc":599}},{"sensore":"63a06eb8daceb65b1eebfcc5","valori":{"temp":15,"hum_rel":37,"CO2":2357,"O2":2933,"tvoc":2810}},{"sensore":"63a06eb8daceb65b1eebfcc7","valori":{"temp":30,"hum_rel":64,"CO2":2809,"O2":629,"tvoc":2996}},{"sensore":"63a06eb8daceb65b1eebfcc9","valori":{"temp":12,"hum_rel":39,"CO2":2759,"O2":2517,"tvoc":2776}},{"sensore":"63a06eb8daceb65b1eebfccb","valori":{"temp":26,"hum_rel":54,"CO2":2495,"O2":1953,"tvoc":1653}},{"sensore":"63a06eb8daceb65b1eebfccd","valori":{"temp":12,"hum_rel":80,"CO2":718,"O2":628,"tvoc":509}},{"sensore":"63a06eb8daceb65b1eebfccf","valori":{"temp":19,"hum_rel":96,"CO2":680,"O2":779,"tvoc":1168}},{"sensore":"63a06eb8daceb65b1eebfcd1","valori":{"temp":39,"hum_rel":76,"CO2":2887,"O2":982,"tvoc":542}},{"sensore":"63a06eb8daceb65b1eebfcd3","valori":{"temp":16,"hum_rel":39,"CO2":2625,"O2":1029,"tvoc":128}},{"sensore":"63a06eb9daceb65b1eebfcd5","valori":{"temp":19,"hum_rel":66,"CO2":795,"O2":2616,"tvoc":1501}},{"sensore":"63a06eb9daceb65b1eebfcd7","valori":{"temp":19,"hum_rel":52,"CO2":1469,"O2":1300,"tvoc":2049}},{"sensore":"63a06eb9daceb65b1eebfcd9","valori":{"temp":28,"hum_rel":63,"CO2":438,"O2":2589,"tvoc":1594}},{"sensore":"63a06eb9daceb65b1eebfcdb","valori":{"temp":19,"hum_rel":65,"CO2":1434,"O2":2642,"tvoc":23246}},{"sensore":"63a06eb9daceb65b1eebfcdd","valori":{"temp":29,"hum_rel":54,"CO2":1839,"O2":804,"tvoc":1432}},{"sensore":"63a06eb9daceb65b1eebfcdf","valori":{"temp":22,"hum_rel":71,"CO2":1609,"O2":2102,"tvoc":2372}},{"sensore":"63a06eb9daceb65b1eebfce1","valori":{"temp":38,"hum_rel":37,"CO2":1765,"O2":2843,"tvoc":1608}},{"sensore":"63a06ebadaceb65b1eebfce3","valori":{"temp":46,"hum_rel":39,"CO2":431,"O2":1165,"tvoc":2368}}])
  })
})